From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: AlphaKR93 <alphakr93@outlook.com>
Date: Sat, 7 Jan 2023 19:41:03 +0900
Subject: [PATCH] Port PaperMC/Paper#8750


diff --git a/src/main/java/net/minecraft/world/inventory/MerchantResultSlot.java b/src/main/java/net/minecraft/world/inventory/MerchantResultSlot.java
index 7acf5ab9339e0134819aab5f270e99e927cc7a62..9a5d99b8a2627fd6eaa6322c84b8274cd50efe30 100644
--- a/src/main/java/net/minecraft/world/inventory/MerchantResultSlot.java
+++ b/src/main/java/net/minecraft/world/inventory/MerchantResultSlot.java
@@ -64,6 +64,13 @@ public class MerchantResultSlot extends Slot {
                     return;
                 }
                 merchantOffer = org.bukkit.craftbukkit.inventory.CraftMerchantRecipe.fromBukkit(event.getTrade()).toMinecraft();
+                // Andromeda start - Port PaperMC/Paper#8750
+                if (player.getLevel().andromedaLevelConfiguration().paperPullRequestsPort.makePlayerPurchaseEventRespectResultItem.enabled) {
+                    stack.setItem(merchantOffer.result.getItem());
+                    stack.setTag(merchantOffer.result.getTag());
+                    stack.setCount(merchantOffer.result.getCount());
+                }
+                // Andromeda end
             }
         }
         this.checkTakeAchievements(stack);
diff --git a/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java b/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java
index 03b9fe1c0e0f8a4e52502e39153ce9cac316613e..7e07776405c5c2a5f8be6a993d63f795e2b41909 100644
--- a/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java
+++ b/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java
@@ -106,4 +106,16 @@ public class LevelConfigurations extends ConfigurationPart {
 
     }
 
+    public PaperPullRequestsPort paperPullRequestsPort;
+    public class PaperPullRequestsPort extends ConfigurationPart {
+
+        public MakePlayerPurchaseEventRespectResultItem makePlayerPurchaseEventRespectResultItem;
+        public class MakePlayerPurchaseEventRespectResultItem extends ConfigurationPart {
+
+            public boolean enabled = false;
+
+        }
+
+    }
+
 }
