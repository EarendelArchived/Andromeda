From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: AlphaKR93 <alphakr93@outlook.com>
Date: Sat, 7 Jan 2023 22:08:21 +0900
Subject: [PATCH] Port PaperMC/Paper#8713


diff --git a/src/main/java/net/minecraft/world/item/HoneycombItem.java b/src/main/java/net/minecraft/world/item/HoneycombItem.java
index 1f8b7b50c6aa24778d87821ae2ff4d019d176082..5e947e85c5d64abdecc713dc9b1a67244b9aaa88 100644
--- a/src/main/java/net/minecraft/world/item/HoneycombItem.java
+++ b/src/main/java/net/minecraft/world/item/HoneycombItem.java
@@ -39,6 +39,7 @@ public class HoneycombItem extends Item {
             ItemStack itemStack = context.getItemInHand();
             // Paper start - EntityChangeBlockEvent
             if (org.bukkit.craftbukkit.event.CraftEventFactory.callEntityChangeBlockEvent(player, blockPos, state).isCancelled()) {
+                if (!player.isCreative() && level.andromedaLevelConfiguration().paperPullRequestsPort.fixDesyncOfHoneycombWhenTheEventIsCancelled) player.containerMenu.sendAllDataToRemote(); // Andromeda - Port PaperMC/Paper#8713
                 return InteractionResult.PASS;
             }
             // Paper end
diff --git a/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java b/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java
index f1ad46fde032a9ae3587390b9eba49b510b39e96..125a41dc84df3f61aed6ffd03ba2c6d3ade4e906 100644
--- a/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java
+++ b/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java
@@ -144,6 +144,8 @@ public class LevelConfigurations extends ConfigurationPart {
 
         public boolean setWardenSpawnReasonToNatural = true;
 
+        public boolean fixDesyncOfHoneycombWhenTheEventIsCancelled = true;
+
     }
 
 }
