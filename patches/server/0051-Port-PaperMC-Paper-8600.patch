From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: AlphaKR93 <alphakr93@outlook.com>
Date: Sat, 7 Jan 2023 22:59:41 +0900
Subject: [PATCH] Port PaperMC/Paper#8600


diff --git a/src/main/java/net/minecraft/world/item/RecordItem.java b/src/main/java/net/minecraft/world/item/RecordItem.java
index 4c6f60cc1269ed0315b7e5a54235b9c95d1f039c..04958a309cfcd99ef27e002e8bcca07b59c0dcd6 100644
--- a/src/main/java/net/minecraft/world/item/RecordItem.java
+++ b/src/main/java/net/minecraft/world/item/RecordItem.java
@@ -43,7 +43,11 @@ public class RecordItem extends Item {
             ItemStack itemstack = context.getItemInHand();
 
             if (!world.isClientSide) {
-                if (true) return InteractionResult.SUCCESS; // CraftBukkit - handled in ItemStack
+                // Andromeda start - Port PaperMC/Paper#8600
+                if (world.andromedaLevelConfiguration().paperPullRequestsPort.removeDuplicateAnimatePacketForRecords.enabled) return InteractionResult.sidedSuccess(world.isClientSide); // CraftBukkit - handled in ItemStack
+                else return InteractionResult.SUCCESS;
+                /*
+                // Andromeda end
                 ((JukeboxBlock) Blocks.JUKEBOX).setRecord(context.getPlayer(), world, blockposition, iblockdata, itemstack);
                 world.levelEvent((Player) null, 1010, blockposition, Item.getId(this));
                 itemstack.shrink(1);
@@ -52,6 +56,7 @@ public class RecordItem extends Item {
                 if (entityhuman != null) {
                     entityhuman.awardStat(Stats.PLAY_RECORD);
                 }
+                 */ // Andromeda
             }
 
             return InteractionResult.sidedSuccess(world.isClientSide);
diff --git a/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java b/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java
index 409b148caabf5cda6eaa840f8133cf80bba60f96..9c67548985d5a34c328d0084c7c29149b3221de7 100644
--- a/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java
+++ b/src/main/java/team/earendel/andromeda/configurations/LevelConfigurations.java
@@ -194,6 +194,13 @@ public class LevelConfigurations extends ConfigurationPart {
 
         }
 
+        public RemoveDuplicateAnimatePacketForRecords removeDuplicateAnimatePacketForRecords;
+        public class RemoveDuplicateAnimatePacketForRecords extends ConfigurationPart {
+
+            public boolean enabled = true;
+
+        }
+
     }
 
 }
